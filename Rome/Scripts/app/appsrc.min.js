"use strict";var myApp=angular.module("myApp",["ngMaterial","ngAnimate","angular.filter","appControllers","appDirectives","appFilters","appServices"]).config(["$compileProvider","$locationProvider","$mdIconProvider","$mdThemingProvider","$httpProvider",function(e,t,n,r,a){e.debugInfoEnabled(!1),t.html5Mode(!0).hashPrefix("!"),n.icon("logo","/Img/Svg/TaxCare.svg",64),r.theme("default").primaryPalette("light-blue",{"default":"900","hue-1":"800","hue-2":"200","hue-3":"100"}).accentPalette("deep-orange",{"default":"A400","hue-1":"A100","hue-2":"A700"}),r.theme("altTheme").backgroundPalette("grey",{"default":"200"}),a.useApplyAsync(!0)}]),appControllers=angular.module("appControllers",["appServices"]);appControllers.controller("loginCtrl",["$scope","$http","loginService","selectedDayService",function(e,t,n,r){e.invalidPassword=!1,e.$watch(function(){return n.user.isLoggedIn},function(t,r){e.isLoggedIn=n.user.isLoggedIn}),this.tryLogin=function(a,o){var i={UserName:a,Password:o};r.selectedDay=void 0;var s=JSON.stringify(i),c={method:"POST",url:"/api/Users/getUser/",data:s};t(c).success(function(t){null!=t?(n.user=t,n.user.isLoggedIn=!0,e.invalidPassword=!1):e.invalidPassword=!0}).error(function(t){e.Error=t})},this.tryLogout=function(){n.user.isLoggedIn=!1}}]),appControllers.controller("tabCtrl",["$scope","loginService",function(e,t){e.User=t.user,this.tab=1,this.setTab=function(e){this.tab=e},this.isSet=function(e){return this.tab===e}}]),appControllers.controller("mainCtrl",["$scope","$mdSidenav",function(e,t){function n(e){t(e).toggle()}e.toggleSidenav=n}]),appControllers.controller("baseCtrl",["$scope","$http","loginService",function(e,t,n){e.baseLoading=!0;var r=JSON.stringify(n.user),a={method:"POST",url:"/api/Bases/getSelectedBases/",data:r};t(a).success(function(t){e.Bases=t,e.baseLoading=!1}).error(function(t){e.Bases=t,e.baseLoading=!1}),e.baseOrder="-BaseStart"}]),appControllers.controller("branchCtrl",["$scope","$http",function(e,t){e.loading=!0,t.get("/api/Administrations/getAdm/").success(function(t){e.Administrations=t,e.loading=!1}).error(function(t){e.Error=t,e.loading=!1})}]),appControllers.controller("calendarCtrl",["$scope","$http","loginService","$mdDialog","globalFunctions","selectedDayService",function(e,t,n,r,a,o){function i(t){var n=angular.element(document.querySelector("#calendar"));r.show({parent:n,targetEvent:t,templateUrl:"/Home/Directives/monthPicker",locals:{years:e.years,months:e.months},controller:"dateDialogCtrl"}).then(function(e){o.selectedDay=moment({year:e.selectedYear,month:e.selectedMonth})})}e.day=moment(),e.$watch(function(){return o.selectedDay},function(t,n){e.day=angular.copy(o.selectedDay)});var s=JSON.stringify(n.user),c={method:"POST",url:"/api/Events/getSelectedEvents/",data:s};t(c).success(function(t){e.EventActions=t,e.loading=!1}).error(function(t){e.Error=t,e.loading=!1}),e.showMonthPicker=i}]),appControllers.controller("profileCtrl",["$scope","loginService",function(e,t){e.user=t.user}]),appControllers.controller("dateDialogCtrl",["$scope","$mdDialog","globalFunctions",function(e,t,n){function r(){t.hide(e.pickerData)}function a(){t.cancel()}n._createMonths(e),n._createYears(e,5),e.submitMonthPicker=r,e.cancelMonthPicker=a,e.pickerData={selectedMonth:moment().format("MMMM"),selectedYear:parseInt(moment().year("YYYY"))}}]);var appServices=angular.module("appServices",[]);appServices.service("globalFunctions",function(){var e={_buildMonth:function(e,t,n){e.weeks=[];var r=!1,a=t.clone(),o=a.month(),i=0;for(a=a.startOf("month").startOf("week");!r;)e.weeks.push({days:this._buildWeek(a.clone(),n)}),a.add(1,"w"),r=i++>2&&o!==a.month(),o=a.month()},_buildWeekDays:function(e,t){var n=angular.copy(moment(t)),r=angular.copy(moment(n)).add(6,"days"),a="";n.format("MM")!==r.format("MM")&&(a=n.format("-MM-YYYY")),e.title=n.format("DD")+a+" - "+r.format("DD-MM-YYYY");var o=[],i=angular.copy(moment(t));i.hour(0).minute(0).second(0).millisecond(0);for(var s=0;24>s;s++)o.push({name:i.format("HH:mm"),hour:i.hour(),minute:i.minute()}),i.add(1,"H"),i=angular.copy(i);e.days=[];for(var s=0;7>s;s++)e.days.push({name:t.format("dddd").toUpperCase(),number:t.date(),isToday:t.isSame(new Date,"day"),date:moment(t),hours:o}),t.add(1,"d"),t=angular.copy(t)},_buildWeek:function(e,t){for(var n=[],r=0;7>r;r++)n.push({name:e.format("dd").substring(0,2),number:e.date(),isCurrentMonth:e.month()===t.month(),isToday:e.isSame(new Date,"day"),date:moment(e)}),e.add(1,"d"),e=angular.copy(e);return n},_buildDay:function(e,t){e.hours=[];for(var n=0;24>n;n++)e.hours.push({name:t.format("HH:mm"),hour:t.hour(),minute:t.minute(),date:moment(t)}),t.add(1,"H"),t=angular.copy(t)},_createMonths:function(e){e.months=[];for(var t=0;12>t;t++)e.months.push({name:moment({month:t}).format("MMMM"),ind:t,isCurrentMonth:moment().month()===moment({month:t}).month()})},_createYears:function(e,t){e.years=[];for(var n=parseInt(moment().format("YYYY")),r=0;2*t+1>r;r++)e.years.push({name:n+r-t,isCurrentYear:n+r-t==n})},_createWeekDays:function(e){e.weekdays=[];for(var t=0;7>t;t++)e.weekdays.push(moment().day(t).format("DDDD"))}};return e}),appServices.service("loginService",function(){var e=function(){this.isLoggedIn=!1};return{user:e}}),appServices.service("selectedDayService",function(){var e;return e});var appFilters=angular.module("appFilters",[]);appFilters.filter("truncDate",["$filter",function(e){return function(t){var n=moment(t).local().startOf("day");return e("date")(n)}}]),appFilters.filter("truncHour",["$filter",function(e){return function(t){var n=moment(t).local().startOf("hour");return e("date")(n)}}]),appFilters.filter("jsDate",function(){return function(e){return e?new Date(parseInt(e.substr(6,13))):void 0}});var appDirectives=angular.module("appDirectives",["appServices","appControllers"]);appDirectives.directive("calendar",["globalFunctions","selectedDayService",function(e,t){return moment.locale("pl"),{controller:"calendarCtrl",restrict:"E",templateUrl:"/Home/Directives/calendarTemplate",scope:{selected:"=",eventactions:"=",selectedindex:"="},link:function(n){t.selectedDay=n.selected||moment().local().startOf("day"),n.$watch(function(){return t.selectedDay},function(r,a){n.month=angular.copy(t.selectedDay);var o=angular.copy(t.selectedDay);e._buildMonth(n,o,n.month)}),n.moveTo=function(e){t.selectedDay=e.date.startOf("day"),n.selectedindex=2},n.next=function(){var t=angular.copy(n.month).add(1,"months");n.month.month(n.month.month()+1),e._buildMonth(n,t,n.month)},n.previous=function(){var t=angular.copy(n.month).subtract(1,"months");n.month.month(n.month.month()-1),e._buildMonth(n,t,n.month)}}}}]),appDirectives.directive("calendarWeek",["globalFunctions","selectedDayService",function(e,t){return moment.locale("pl"),{controller:"calendarCtrl",restrict:"E",templateUrl:"/Home/Directives/calendarWeekTemplate",scope:{selected:"=",eventactions:"=",selectedindex:"="},link:function(n){n.$watch(function(){return t.selectedDay},function(r,a){e._buildWeekDays(n,moment(t.selectedDay).startOf("week"))}),n.nextWeek=function(){t.selectedDay.add(1,"weeks"),e._buildWeekDays(n,moment(t.selectedDay).startOf("week"))},n.previousWeek=function(){t.selectedDay.subtract(1,"weeks"),e._buildWeekDays(n,moment(t.selectedDay).startOf("week"))}}}}]),appDirectives.directive("calendarDay",["globalFunctions","selectedDayService",function(e,t){return moment.locale("pl"),{controller:"calendarCtrl",restrict:"E",templateUrl:"/Home/Directives/calendarDayTemplate",scope:{selected:"=",eventactions:"=",selectedindex:"="},link:function(n){n.$watch(function(){return t.selectedDay},function(r,a){var o=angular.copy(moment(t.selectedDay).startOf("day"));e._buildDay(n,o)}),n.nextDay=function(){t.selectedDay=angular.copy(t.selectedDay.add(1,"days"))},n.previousDay=function(){t.selectedDay=angular.copy(t.selectedDay.subtract(1,"days"))},n.pickDate=function(e){n.selected=angular.copy(e),n.selectedindex=0}}}}]),appDirectives.directive("eventForm",["$interval",function(e){return{controller:"baseCtrl",restrict:"E",templateUrl:"/Home/Directives/eventForm",scope:{baseoptionset:"=",client:"=",baseid:"="},link:function(e){e.now=moment().startOf("hour").toDate(),e.max=moment().add(10,"years").startOf("day").toDate(),e.submittedEvent={NextEventDate:e.now,Client:e.client,BaseId:e.baseid,Products:[]},e.clearSelectResult=function(){e.submittedEvent.Products=[],e.submittedEvent.ResignationReason=void 0,e.submittedEvent.NextEvent=void 0,e.submittedEvent.NextEventDate=e.now},e.clearSelectType=function(){e.clearSelectResult(),e.submittedEvent.Result=void 0},e.addProduct=function(){e.submittedEvent.Products.push({Count:e.submittedEvent.Products.length+1,Product:{},Value:null})},e.removeProduct=function(){var t=e.submittedEvent.Products.length-1;e.submittedEvent.Products.splice(t)},e.submitEvent=function(){}}}}]);